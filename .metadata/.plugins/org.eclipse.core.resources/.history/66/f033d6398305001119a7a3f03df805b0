package com.teknikos.WestgateMobileApp.tests;

import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import com.teknikos.WestgateMobileApp.base.BaseTest;
import com.teknikos.WestgateMobileApp.base.pages.LoginPage;
import com.teknikos.WestgateMobileApp.core.DriverManager;
import com.teknikos.WestgateMobileApp.utils.ExtentReportManager;

import static org.testng.Assert.assertTrue;

public class WestgateRegressionTest extends BaseTest {

    private LoginPage loginPage;

    @BeforeClass
    public void setUp() {
        ExtentReportManager.setupReport();
        loginPage = new LoginPage(DriverManager.getDriver());
    }

    @AfterClass
    public void tearDown() {
        ExtentReportManager.tearDownReport();
    }

    // ----------------------------------------------------
    // 1️⃣ APP LAUNCH TEST
    // ----------------------------------------------------
    @Test(priority = 1)
    public void verifyAppLaunch() {

        ExtentReportManager.startTest(
                "Verify App Launch",
                "Verify application launches successfully"
        );

        assertTrue(
                loginPage.isElementPresent(
                        DriverManager.getDriver()
                                .findElementByXPath("//android.widget.TextView[@text='Continue as a Guest']"),
                        10
                ),
                "App did not launch successfully"
        );
    }

    // ----------------------------------------------------
    // 2️⃣ LOGIN TEST
    // ----------------------------------------------------
    @Test(priority = 2)
    public void verifyLoginFunctionality() throws InterruptedException {

        ExtentReportManager.startTest(
                "Verify Login Functionality",
                "Verify user can login with valid credentials"
        );

        loginPage.loginAsRegisteredUser(
                "KDORTCH55@GMAIL.COM",
                "password"
        );

        assertTrue(
                loginPage.isHomeTabVisible(),
                "Login failed - Home tab not visible"
        );
    }
}
