package com.teknikos.WestgateMobileApp.base.pages;

import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.PageFactory;


import io.appium.java_client.android.AndroidDriver;
import io.appium.java_client.android.nativekey.AndroidKey;
import io.appium.java_client.android.nativekey.KeyEvent;
import io.appium.java_client.pagefactory.AndroidFindBy;
import io.appium.java_client.pagefactory.AppiumFieldDecorator;
import static org.testng.Assert.assertTrue;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

public class LoginPage extends ElementUtils {

    private static final Logger logger = LogManager.getLogger(LoginPage.class);

  //  private final AndroidDriver driver;

    public LoginPage(AndroidDriver driver) {
        super(driver);
    //    this.driver = driver;
        PageFactory.initElements(new AppiumFieldDecorator(driver), this);
    }

    @AndroidFindBy(xpath = "//android.widget.Button[@resource-id='idBtn_Back']")
    private WebElement backButton;

    public void performLoginWithEnterKey() {
    	logger.info("Login process simulated with Enter key.");
       // wait.until(ExpectedConditions.visibilityOf(backButton));
    	assertTrue(isElementPresent(backButton,10));
        driver.pressKey(new KeyEvent(AndroidKey.ENTER));
        ElementUtils.pressEnterWithDelay(driver, 3000);
        driver.pressKey(new KeyEvent(AndroidKey.ENTER));

        logger.info("Login process simulated with Enter key.");
    }

    public boolean isBackButtonVisible() {
        try {
            return backButton.isDisplayed();
        } catch (Exception e) {
            logger.warn("Back button not visible after login attempt");
            return false;
        }
    }
}
